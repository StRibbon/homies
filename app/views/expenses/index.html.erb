<h1><%= @sphere.name %></h1>

<%= link_to "Add Expense", new_user_sphere_expense_path %>
<ul>
<% @expenses.each do |expense| %>
<li>
<strong>Name:</strong> <%= expense.name %>
<strong>Cost:</strong> <%= expense.cost %>
<strong>Notes:</strong> <%= expense.notes %>
<strong>Category:</strong> <%= expense.category.name %>

<%= link_to "Edit", edit_expense_path(expense.id) %>
<%= link_to "Delete", expense_path(expense.id), method: :delete, data: { confirm: 'Are you sure?' } %>

</li>
<% end %>
</ul>
<h4>Total</h4>
$<%= total_expense_amount_sphere(@sphere)%>
<br>
<h4>Number of users in sphere</h4>
<%= number_of_user_in_sphere(@id) %>
<h4>Per person</h4>
<%= total_expense_amount_sphere(@sphere) / number_of_user_in_sphere(@id) %>
<h4>Total spend by Category</h4>
<% total_expense_by_category(@id).each do |expense|%>
  $<%= expense["sum"] %>
  <%= expense["name"] %> <br>
<% end %>
<br>
<h4>Total spend by User</h4>
<% total_expense_by_user(@id).each do |expense|%>
  $<%= expense["sum"] %>
  <%= expense["username"] %> <br>
<% end %>

<h4>Expense by User</h4>
<% user_id_in_sphere(@id).each do |user|%>
   <% x = user["user_id"] %>
   <% itemized_expense_by_user(@id, x).each do |item|%>
      $<%= item["cost"] %>
      <%= item["name"] %>
      <%= item["username"] %><br>
   <% end %>
<% end %>
<br>
<h4>Expense by Category by User</h4>
<% user_id_in_sphere(@id).each do |user|%>
   <% x = user["user_id"] %>
   <% total_expense_by_category_by_user(@id, x).each do |item|%>
      $<%= item["sum"] %>
      <%= item["name"] %>
      <%= item["username"] %><br>
   <% end %>
<% end %>
<h4>Expense by User by Category</h4>
<% cat_id_in_sphere(@id).each do |cat|%>
   <% x = cat["category_id"] %>
   <% total_expense_by_user_by_cat(@id, x).each do |item|%>
      $<%= item["sum"] %>
      <%= item["name"] %>
      <%= item["username"] %><br>
   <% end %>
<% end %>
<div id="chartContainer1" style="height: 300px; width: 600px;">
</div>
<div id="chartContainer2" style="height: 300px; width: 600px;">
</div>
<div id="chartContainer3" style="height: 300px; width: 600px;">
</div>
<div id="chartContainer4" style="height: 300px; width: 600px;">
</div>
<div id="chartContainer5" style="height: 300px; width: 600px;">
</div>

<script type="text/javascript">
  window.onload = function () {
    var chart1 = new CanvasJS.Chart("chartContainer1",
    {
      title:{
        text: "<%= @sphere.name %> Total by Category"
      },
      data: [
      {
        type: "bar",
        dataPoints: [
          <% total_expense_by_category(@id).each do |expense|%>
            { y:<%= expense["sum"] %>, label:"<%= expense["name"] %>" },
          <% end %>
        ]
      },
      ]
    });
    var chart2 = new CanvasJS.Chart("chartContainer2",
    {
      title:{
        text: "<%= @sphere.name %> Total by User"
      },
      data: [
      {
        type: "bar",
        dataPoints: [
          <% total_expense_by_user(@id).each do |expense|%>
            { y:<%= expense["sum"] %>, label:"<%= expense["username"] %>" },
          <% end %>
        ]
      },
      ]
    });

    var chart3 = new CanvasJS.Chart("chartContainer3",
	{
		title:{
			text: "<%= @sphere.name %> Total by Category"
		},
		legend: {
			maxWidth: 350,
			itemWidth: 120
		},
		data: [
		{
			type: "pie",
			showInLegend: true,
			legendText: "{indexLabel}",
			dataPoints: [

        <% total_expense_by_category(@id).each do |expense|%>
          { y:<%= expense["sum"] %>, indexLabel:"<%= expense["name"] %>" },
        <% end %>
			]
		}
		]
	});

  var chart4 = new CanvasJS.Chart("chartContainer4",
{
  title:{
    text: "<%= @sphere.name %> Total by User"
  },
  legend: {
    maxWidth: 350,
    itemWidth: 120
  },
  data: [
  {
    type: "pie",
    showInLegend: true,
    legendText: "{indexLabel}",
    dataPoints: [

      <% total_expense_by_user(@id).each do |expense|%>
        { y:<%= expense["sum"] %>, indexLabel:"<%= expense["username"] %>" },
      <% end %>
    ]
  }
  ]
});

var chart5 = new CanvasJS.Chart("chartContainer5",
   {
     title:{
     text: "Evening Sales of a Restaurant"
     },

     axisX: {
       valueFormatString: "MMM",
       interval: 1,
       intervalType: "month"
     },

     data: [
     {
       type: "stackedBar",
       legendText: "meals",
       showInLegend: "true",
       dataPoints: [
       { x: new Date(2012, 01, 1), y: 71 },
       { x: new Date(2012, 02, 1), y: 55},
       { x: new Date(2012, 03, 1), y: 50 },
       { x: new Date(2012, 04, 1), y: 65 },
       { x: new Date(2012, 05, 1), y: 95 }

       ]
     },
       {
       type: "stackedBar",
       legendText: "snacks",
       showInLegend: "true",
       dataPoints: [
       { x: new Date(2012, 01, 1), y: 71 },
       { x: new Date(2012, 02, 1), y: 55},
       { x: new Date(2012, 03, 1), y: 50 },
       { x: new Date(2012, 04, 1), y: 65 },
       { x: new Date(2012, 05, 1), y: 95 }

       ]
     },
       {
       type: "stackedBar",
       legendText: "drinks",
       showInLegend: "true",
       dataPoints: [
       { x: new Date(2012, 01, 1), y: 71 },
       { x: new Date(2012, 02, 1), y: 55},
       { x: new Date(2012, 03, 1), y: 50 },
       { x: new Date(2012, 04, 1), y: 65 },
       { x: new Date(2012, 05, 1), y: 95 }

       ]
     },

       {
       type: "stackedBar",
       legendText: "dessert",
       showInLegend: "true",
       dataPoints: [
       { x: new Date(2012, 01, 1), y: 61 },
       { x: new Date(2012, 02, 1), y: 75},
       { x: new Date(2012, 03, 1), y: 80 },
       { x: new Date(2012, 04, 1), y: 85 },
       { x: new Date(2012, 05, 1), y: 105 }

       ]
     },
       {
       type: "stackedBar",
       legendText: "takeaway",
       showInLegend: "true",
       dataPoints: [
       { x: new Date(2012, 01, 1), y: 20 },
       { x: new Date(2012, 02, 1), y: 35},
       { x: new Date(2012, 03, 1), y: 30 },
       { x: new Date(2012, 04, 1), y: 45 },
       { x: new Date(2012, 05, 1), y: 25 }

       ]
     }

     ]
   });



chart1.render();
chart2.render();
chart3.render();
chart4.render();
chart5.render();
}
</script>
